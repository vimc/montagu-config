vault:
  addr: https://vault.dide.ic.ac.uk:8200
  auth:
    method: github

# Prefix for container names; we'll use {container_prefix}-(container_name)
container_prefix: montagu

## Set this flag to true to prevent use of --volumes in the cli to remove
## volumes on stop
protect_data: true

## Docker org for images
repo: ghcr.io/vimc

## The name of the docker network that containers will be attached to.
## If you want to proxy Packit to the host, you will need to
## arrange a proxy on this network
network: montagu_default

# Domain where this instance of Montagu will be deployed. E.g. science.montagu.dide.ic.uk
hostname: montagu.vaccineimpact.org

## Names of the docker volumes to use
volumes:
  db: montagu_db_volume_v17
  burden_estimates: montagu_burden_estimate_files
  emails: montagu_emails
  templates: montagu_template_volume
  guidance: montagu_guidance_volume
  static: montagu_static_volume
  static_logs: montagu_static_logs
  mq: montagu_mq
  acme-challenge: montagu_acme_challenge
  certificates: montagu_certificates
  certbot: montagu_certbot

api:
  name: montagu-api
  tag: main
  admin:
    name: montagu-cli
    tag: main
  email:
    password: VAULT:secret/vimc/email/password:value
    flow_url: VAULT:secret/vimc/flow/montagu-webhook:value
db:
  name: montagu-db
  tag: main
  root_user: vimc
  migrate:
    name: montagu-migrate
    tag: main
  users:
    api:
      password: VAULT:secret/vimc/database/production/users/api:password
      permissions: all
    import:
      password: VAULT:secret/vimc/database/production/users/import:password
      permissions: all
    orderly:
      password: VAULT:secret/vimc/database/production/users/orderly:password
      permissions: all
    readonly:
      password: VAULT:secret/vimc/database/production/users/readonly:password
      permissions: readonly
    barman:
      password: VAULT:secret/vimc/database/production/users/barman:password
      option: superuser
    streaming_barman:
      password: VAULT:secret/vimc/database/production/users/streaming_barman:password
      option: replication
  protected_tables:
    - gavi_support_level
    - activity_type
    - burden_outcome
    - gender
    - responsibility_set_status
    - impact_outcome
    - gavi_support_level
    - support_type
    - touchstone_status
    - permission
    - role
    - role_permission
proxy:
  name: montagu-proxy
  tag: main
  port_http: 80
  port_https: 443
  metrics:
    repo: nginx
    name: nginx-prometheus-exporter
    tag: 1.3.0
  acme:
    email: reside@imperial.ac.uk
    additional_domains:
      - production2.montagu.dide.ic.ac.uk
contrib:
  name: montagu-contrib-portal
  tag: main
admin:
  name: montagu-admin-portal
  tag: main
static:
  name: montagu-static
  tag: main
mq:
  repo: docker.io
  name: redis
  tag: latest
  port: 6379
flower:
  repo: mher
  name: flower
  tag: 0.9.5
  port: 5555
task_queue:
  name: task-queue-worker
  tag: main
  tasks:
    diagnostic_reports:
      use_additional_recipients: false
      poll_seconds: 5
    archive_folder_contents:
      min_file_age_seconds: 3600
  servers:
    youtrack:
      token: VAULT:secret/vimc/youtrack-integration/youtrack:token
    packit:
      url: https://montagu.vaccineimpact.org/packit
      disable_certificate_verify: false
    montagu:
      user: montagu-task@imperial.ac.uk
      password: VAULT:secret/vimc/task-queue-user/production:password
    smtp:
      host: smtp.cc.ic.ac.uk
      port: 587
      user: montagu
      password: VAULT:secret/vimc/email/password:value
      from: montagu-notifications@imperial.ac.uk

packit_api_url: https://montagu.vaccineimpact.org/packit/api
